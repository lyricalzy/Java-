<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>Insert title here</title>
		<script type="text/javascript" src="js/jquery-3.4.1.js"></script>
		<script type="text/javascript">
			$(function() {
				$('#b1').click(function() {
					$('#t1').empty()
					$.ajax({
						url: 'https://api.rss2json.com/v1/api.json?rss_url=http%3A%2F%2Fwww.chosun.com%2Fsite%2Fdata%2Frss%2Frss.xml&api_key=e4dcoikoetkw7oasr8qrvuv8rxwk5ct53rdut0mt',
						data: {
							url: 'http://www.chosun.com/site/data/rss/rss.xml',
							api_key: 'e4dcoikoetkw7oasr8qrvuv8rxwk5ct53rdut0mt',
							count: 20
						},
						success: function(doc) {
							console.log('연결 성공' + doc)
							items = doc.items
							console.log(items.length)
							if (items.length > 0) {
								$(items).each(function(i, news) {
									console.log(news.title)
									title = news.title
									link = '<a href=' + news.link + '>'
									thumbnail = '<img src=' + news.thumbnail + ' width=100 height=100>'
									author = news.author
									date = news.pubDate
									categorie = news.categories[0]
									$('#t1').append('<tr><td>' + thumbnail + '</td><td>' 
											+ link +  title + '</td></tr>')
									$.ajax({
										url: 'db03.jsp',
										data:{
											title: title,
											author: author,
											date: date,
											categorie: categorie,
										},
										success: function() {
											console.log('db에 전송 성공!')
										}
									})
								})
							}
						} // success
					}) // ajax
				}) // click
				$('#b2').click(function() {
					$('#t1').empty()
					$.ajax({
						url: 'https://api.rss2json.com/v1/api.json?rss_url=http%3A%2F%2Fwww.chosun.com%2Fsite%2Fdata%2Frss%2Fent.xml&api_key=e4dcoikoetkw7oasr8qrvuv8rxwk5ct53rdut0mt',
						data: {
							url: 'http://www.chosun.com/site/data/rss/ent.xml',
							api_key: 'e4dcoikoetkw7oasr8qrvuv8rxwk5ct53rdut0mt',
							count: 20
						},
						success: function(doc) {
							console.log('연결 성공' + doc)
							items = doc.items
							console.log(items.length)
							if (items.length > 0) {
								$(items).each(function(i, news) {
									console.log(news.title)
									title = news.title
									link = '<a href=' + news.link + '>'
									thumbnail = '<img src=' + news.thumbnail + ' width=100 height=100>'
									author = news.author
									date = news.pubDate
									categorie = news.categories[0]
									$('#t1').append('<tr><td>' + thumbnail + '</td><td>' 
											+ link +  title + '</td></tr>')
									$.ajax({
										url: 'db03.jsp',
										data:{
											title: title,
											author: author,
											date: date,
											categorie: categorie,
										},
										success: function() {
											console.log('db에 전송 성공!')
										}
									})
								})
							}
						} // success
					}) // ajax
				}) // click
				$('#b3').click(function() {
					$('#t1').empty()
					$.ajax({
						url: 'https://api.rss2json.com/v1/api.json?rss_url=http%3A%2F%2Fphoto.chosun.com%2Fsite%2Fdata%2Frss%2Frss.xml&api_key=e4dcoikoetkw7oasr8qrvuv8rxwk5ct53rdut0mt',
						data: {
							url: 'http://photo.chosun.com/site/data/rss/rss.xml',
							api_key: 'e4dcoikoetkw7oasr8qrvuv8rxwk5ct53rdut0mt',
							count: 20
						},
						success: function(doc) {
							console.log('연결 성공' + doc)
							items = doc.items
							console.log(items.length)
							if (items.length > 0) {
								$(items).each(function(i, news) {
									title = news.title
									link = '<a href=' + news.link + '>'
									thumbnail = '<img src=' + news.thumbnail + ' width=100 height=100>'
									author = news.author
									date = news.pubDate
									categorie = news.categories[0]
									$('#t1').append('<tr><td>' + thumbnail + '</td><td>' 
											+ link +  title + '</td></tr>')
									$.ajax({
										url: 'db03.jsp',
										data:{
											title: title,
											author: author,
											date: date,
											categorie: categorie,
										},
										success: function() {
											console.log('db에 전송 성공!')
										}
									})
								})
							}
						} // success
					}) // ajax
				}) // click
			}) // main
		</script>
	</head>
	<body>
		<button id="b1">속보</button>
		<button id="b2">연예</button>
		<button id="b3">사진</button>
		<hr>
		<table id="t1"></table>
	</body>
</html>